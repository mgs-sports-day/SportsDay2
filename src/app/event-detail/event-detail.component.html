<mat-progress-bar mode="indeterminate" *ngIf="loading"></mat-progress-bar>

<div *ngIf="!loading">
    <h1>{{ event.name }}</h1>

    <mat-tab-group ngClass="special-padding-tab">
        <mat-tab *ngFor="let year of [7, 8, 9, 10]" [label]="'Year ' + year">

            <mat-tab-group selectedIndex="0">
                <mat-tab *ngFor="let competitor of subEventArray(event.competitors)" [label]="'Competitor ' + competitor">

                    <div class="special-padding-content">
                        <div class="mat-elevation-z8">
                            <table mat-table [dataSource]="scoreBreakdown[year][competitor]" class="breakdown-table">

                                <ng-container matColumnDef="form">
                                    <th mat-header-cell *matHeaderCellDef>Form</th>

                                    <td mat-cell *matCellDef="let element">
                                        {{ element.form.year }}{{ element.form.name }}
                                    </td>
                                </ng-container>

                                <ng-container matColumnDef="position">
                                    <th mat-header-cell *matHeaderCellDef>Position</th>

                                    <td mat-cell *matCellDef="let element">
                                        {{ element.rank }}
                                    </td>
                                </ng-container>

                                <ng-container matColumnDef="points">
                                    <th mat-header-cell *matHeaderCellDef>Points</th>

                                    <td mat-cell *matCellDef="let element">
                                        {{ element.score }}
                                    </td>
                                </ng-container>

                                <ng-container matColumnDef="actions">
                                    <th mat-header-cell *matHeaderCellDef></th>

                                    <td mat-cell *matCellDef="let element">

                                        <a mat-raised-button color="primary" [routerLink]="'/forms/' + element.form.id">
                                            View form
                                        </a>

                                    </td>
                                </ng-container>

                                <tr mat-header-row *matHeaderRowDef="['form', 'position', 'points', 'actions']"></tr>
                                <tr mat-row
                                    *matRowDef="let row; columns: ['form', 'position', 'points', 'actions']"
                                    [ngClass]="'table-position-' + (row.rank - 1)"
                                ></tr>

                            </table>
                        </div>
                    </div>

                </mat-tab>
            </mat-tab-group>

        </mat-tab>
    </mat-tab-group>

</div>
