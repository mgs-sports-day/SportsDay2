<mat-progress-bar mode="indeterminate" *ngIf="loading"></mat-progress-bar>

<div *ngIf="!loading">
    <h1>
        {{ form.year }}{{ form.name }}
    </h1>

    <mat-tab-group>
        <mat-tab label="Statistics">

            <div class="mat-elevation-z8">
                <table mat-table [dataSource]="statistics">
                    <ng-container matColumnDef="name">
                        <td mat-cell *matCellDef="let element">
                            {{ element.name }}
                        </td>
                    </ng-container>

                    <ng-container matColumnDef="value">

                        <td mat-cell *matCellDef="let element">
                            <strong>
                                {{ element.value }}
                            </strong>
                        </td>

                    </ng-container>

                    <tr mat-row
                        *matRowDef="let row; columns: ['name', 'value']"
                        [ngClass]="row.name !== 'Total points' ? ('table-position-' + ( row.value - 1)) : ''"></tr>
                </table>
            </div>


        </mat-tab>

        <mat-tab label="Events breakdown">

            <div class="mat-elevation-z8">
                <table class="breakdown-table mat-table">
                    <thead>
                        <tr class="mat-header-row">
                            <th rowspan="2" class="mat-header-cell">Event</th>

                            <th colspan="2" class="mat-header-cell">Competitor A</th>
                            <th colspan="2" class="mat-header-cell">Competitor B</th>
                            <th colspan="2" class="mat-header-cell">Competitor C</th>

                            <th rowspan="2" class="mat-header-cell padding-left">Total points</th>
                        </tr>
                        <tr class="mat-header-row">
                            <th class="mat-header-cell">Position</th>
                            <th class="mat-header-cell">Points</th>

                            <th class="mat-header-cell">Position</th>
                            <th class="mat-header-cell">Points</th>

                            <th class="mat-header-cell">Position</th>
                            <th class="mat-header-cell">Points</th>
                        </tr>
                    </thead>

                    <tbody>
                        <tr class="mat-row"
                            *ngFor="let event of eventsBreakdown">
                            <td class="mat-cell">
                                <a class="no-link-dark" [routerLink]="'/events/' + event.id">
                                    {{ event.name }}
                                </a>
                            </td>

                            <td class="mat-cell rank-cell" [ngClass]="'table-position-' + (event.A.rank - 1)">
                                {{ event.A.rank }}
                            </td>
                            <td class="mat-cell">{{ event.A.score || 0 }}</td>

                            <td class="mat-cell rank-cell" [ngClass]="'table-position-' + (event.B.rank - 1)">
                                {{ event.B.rank }}
                            </td>
                            <td class="mat-cell">{{ event.B.score || 0 }}</td>

                            <td class="mat-cell rank-cell" [ngClass]="'table-position-' + (event.C.rank - 1)">
                                {{ event.C.rank }}
                            </td>
                            <td class="mat-cell">{{ event.C.score || 0 }}</td>

                            <td class="mat-cell">{{ event.total }}</td>
                        </tr>
                    </tbody>
                </table>
            </div>

        </mat-tab>
    </mat-tab-group>
</div>
